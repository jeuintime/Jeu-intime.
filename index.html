<!DOCTYPE html><html lang="fr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Jeu Intime à Distance</title><script src="https://cdn.tailwindcss.com"></script><style>@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');body{font-family:'Inter',sans-serif;background-color:#f7f3f1;display:flex;justify-content:center;align-items:center;min-height:100vh;padding:1rem;color:#4b5563;}@media (max-width:640px){body{flex-direction:column;}} .container{width:100%;max-width:600px;background-color:white;border-radius:2rem;box-shadow:0 10px 25px rgba(0,0,0,0.1);padding:2rem;text-align:center;}h1{font-size:2.5rem;font-weight:700;color:#ef4444;margin-bottom:1.5rem;}.card{background-color:#fce7f3;border-radius:1.5rem;padding:1.5rem;margin-bottom:1.5rem;}.question{font-size:1.25rem;font-weight:600;line-height:1.5;margin-bottom:1rem;}textarea,input[type="text"]{width:100%;height:8rem;padding:0.75rem;border:1px solid #d1d5db;border-radius:0.75rem;resize:none;outline:none;margin-bottom:0.75rem;}input[type="text"]{height:auto;margin-bottom:1rem;text-align:center;}textarea:focus,input:focus{border-color:#f472b6;box-shadow:0 0 0 2px #f472b6;}.button{display:inline-block;width:100%;padding:0.75rem 1.5rem;border-radius:9999px;font-weight:700;color:white;box-shadow:0 4px 6px rgba(0,0,0,0.1);transition:transform 0.2s ease-in-out,box-shadow 0.2s ease-in-out;cursor:pointer;}.button.rose{background-color:#ef4444;}.button.green{background-color:#22c55e;}.button.purple{background-color:#a855f7;}.button:hover{transform:scale(1.05);box-shadow:0 6px 8px rgba(0,0,0,0.15);}.disabled{background-color:#9ca3af;cursor:not-allowed;transform:none;}.answers-container{background-color:white;border-radius:2rem;box-shadow:0 10px 25px rgba(0,0,0,0.1);padding:2rem;margin-top:2rem;}.answer-box{background-color:#f3f4f6;padding:1rem;border-radius:0.75rem;margin-top:1rem;text-align:left;}.answer-label{font-weight:700;font-size:1.125rem;margin-bottom:0.25rem;color:#374151;}.revealed-question{font-style:italic;font-size:1.125rem;margin-bottom:1rem;}.gemini-analysis{background-color:#e0f2fe;border-left:4px solid #38bdf8;padding:1rem;margin-top:1rem;border-radius:0.5rem;text-align:left;}.gemini-analysis-title{font-weight:700;color:#0c4a6e;margin-bottom:0.5rem;}</style></head><body><div class="container"><div id="login-screen"><h1>Jeu Intime ❤️</h1><p class="text-lg font-semibold mb-4">Entrez votre nom et choisissez une partie</p><input type="text" id="my-name-input" placeholder="Mon nom" class="mb-4"><button id="create-game-button" class="button rose mb-2">Créer une partie</button><p class="text-lg font-semibold my-4">OU</p><input type="text" id="game-id-input" placeholder="Code de la partie" class="mb-4"><button id="join-game-button" class="button green">Rejoindre une partie</button><p id="status-message" class="text-sm mt-2"></p></div><div id="setup-screen" style="display: none;"><h1>Jeu Intime ❤️</h1><p class="text-lg font-semibold mb-4">Entrez le nom de votre partenaire</p><div id="name-inputs"><input type="text" id="partner-name-input" placeholder="Nom de ma copine"></div><p class="text-lg font-semibold mt-4 mb-2">Qui commence ?</p><div id="gender-selection" class="flex flex-col gap-4"><button id="select-homme" class="button rose">Un homme commence</button><button id="select-femme" class="button green">Une femme commence</button></div><p id="game-code-display" class="mt-4 text-md font-bold text-gray-700"></p></div><div id="game-container" style="display: none;"><div id="game-card" class="card"><p id="question-text" class="question"></p><textarea id="player-answer" placeholder="Votre réponse..."></textarea><button id="submit-button" class="button rose">Soumettre ma réponse</button><div class="mt-4 flex flex-col gap-2"><button id="get-new-questions-button" class="button purple">Obtenir des questions ✨</button><p id="get-questions-status" class="text-sm text-gray-500"></p></div></div><div id="answers-display" class="answers-container" style="display: none;"><h2 style="font-size: 1.5rem; font-weight: 700; color: #ef4444; margin-bottom: 1.5rem;">Réponses</h2><div class="answer-box"><p class="answer-label" id="player1-label">Réponse de la personne 1 :</p><p class="revealed-question" id="revealed-question-1"></p><p id="revealed-player1-answer"></p></div><div class="answer-box"><p class="answer-label" id="player2-label">Réponse de la personne 2 :</p><p class="revealed-question" id="revealed-question-2"></p><p id="revealed-player2-answer"></p></div><button id="next-button" class="button green mt-4">Question suivante</button><button id="analyze-button" class="button purple mt-4">Analyse Gemini ✨</button><p id="analyze-status" class="text-sm text-gray-500 mt-2"></p><div id="gemini-analysis-output" class="gemini-analysis mt-4" style="display:none;"><h3 class="gemini-analysis-title">Analyse Gemini</h3><p id="gemini-analysis-text"></p></div></div></div></div><script type="module">import{initializeApp}from"https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";import{getAuth,signInWithCustomToken,signInAnonymously}from"https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";import{getFirestore,doc,getDoc,setDoc,onSnapshot,collection}from"https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";import{setLogLevel}from"https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";setLogLevel('debug');const appId=typeof __app_id!=='undefined'?__app_id:'default-app-id';const firebaseConfig=typeof __firebase_config!=='undefined'?JSON.parse(__firebase_config):{};const app=initializeApp(firebaseConfig);const db=getFirestore(app);const auth=getAuth(app);let userId='';let myName='';let gameId='';let isCreator=false;const loginScreen=document.getElementById('login-screen');const setupScreen=document.getElementById('setup-screen');const gameContainer=document.getElementById('game-container');const myNameInput=document.getElementById('my-name-input');const partnerNameInput=document.getElementById('partner-name-input');const createGameButton=document.getElementById('create-game-button');const joinGameButton=document.getElementById('join-game-button');const gameIdInput=document.getElementById('game-id-input');const statusMessage=document.getElementById('status-message');const selectHommeButton=document.getElementById('select-homme');const selectFemmeButton=document.getElementById('select-femme');const questionTextElement=document.getElementById('question-text');const playerAnswerElement=document.getElementById('player-answer');const submitButton=document.getElementById('submit-button');const nextButton=document.getElementById('next-button');const answersDisplay=document.getElementById('answers-display');const player1Label=document.getElementById('player1-label');const player2Label=document.getElementById('player2-label');const revealedQuestion1Element=document.getElementById('revealed-question-1');const revealedQuestion2Element=document.getElementById('revealed-question-2');const revealedPlayer1Answer=document.getElementById('revealed-player1-answer');const revealedPlayer2Answer=document.getElementById('revealed-player2-answer');const getNewQuestionsButton=document.getElementById('get-new-questions-button');const getQuestionsStatusElement=document.getElementById('get-questions-status');const analyzeButton=document.getElementById('analyze-button');const analyzeStatusElement=document.getElementById('analyze-status');const geminiAnalysisOutput=document.getElementById('gemini-analysis-output');const geminiAnalysisText=document.getElementById('gemini-analysis-text');const gameCodeDisplay=document.getElementById('game-code-display');const questionsPourHomme=["Quelle est ta position sexuelle préférée et pourquoi ?","Quel est ton plus grand désir en ce moment, quelque chose que nous n'avons pas encore fait ?","Y a-t-il une partie de notre vie intime que tu aimerais explorer davantage ?","Quel est le plus grand défi sexuel que tu aimerais relever avec moi ?","Quelle est la partie de son corps que tu préfères explorer ?","Y a-t-il une expérience que tu as eue avec un(e) ex que tu aimerais recréer ou améliorer avec moi ?","Si tu pouvais choisir n'importe quel rôle pour un jeu de rôle sexuel, lequel choisirais-tu avec elle ?","Y a-t-il quelque chose que tu n'as pas encore osé lui dire à propos de tes désirs ?","Quel est l'endroit le plus insolite où tu as fantasmé de faire l'amour avec moi ?","Quel est l'accessoire que tu aimerais que nous intégrions à nos jeux sexuels ?","Quel est le son ou le mot qui t'excite le plus pendant nos moments d'intimité ?","Quand as-tu réalisé que tu tombais amoureux de moi ?","Quelle est ta plus grande insécurité en amour ?","Comment me décrirais-tu en tant qu'amant(e) ?","Y a-t-il un moment de notre histoire que tu aimerais revivre ?","Que penses-tu de l'idée d'ouvrir notre couple à de nouvelles expériences ?","Quelle est la chose la plus folle que tu aimerais que nous fassions ensemble ?","Comment gères-tu la jalousie dans une relation ?","Quel est l'impact de notre intimité sur ton bien-être mental ?","Quel est le plus grand défi que nous ayons surmonté ensemble ?","Que ferais-tu si tu savais que je n'aurais jamais à le savoir ?",];const questionsPourFemme=["Comment s'appelle celui qui a pris ta virginité ?","Combien d'ex as-tu eu ?","Es-tu du genre avec ou sans préservatif avec tes ex ?","As-tu déjà embrassé ou fait l'amour avec une fille ?","As-tu déjà fait l'amour avec un inconnu ?","Quel est ton plus grand fantasme sexuel, et pourquoi ne l'avons-nous pas encore réalisé ?","Y a-t-il un rôle ou un scénario que tu as toujours voulu explorer ?","Si tu avais une baguette magique pour un moment, quel fantasme d'intimité se réaliserait ce soir ?","Quelle est ta position sexuelle préférée et pourquoi ?","Quel est ton plus grand désir en ce moment, quelque chose que nous n'avons pas encore fait ?","Quel est l'endroit le plus insolite où tu as fantasmé de faire l'amour avec moi ?","Quel est l'accessoire que tu aimerais que nous intégrions à nos jeux sexuels ?","Décris-moi ta meilleure expérience sexuelle avant moi. Qu'est-ce qui l'a rendue si spéciale ?","Y a-t-il quelque chose que tu n'as pas encore osé me dire à propos de tes désirs ?","Quel est le son ou le mot qui t'excite le plus pendant nos moments d'intimité ?","Quelle est la chose la plus risquée que tu aies faite par amour ?","Quel est le secret que tu n'as jamais dit à personne ?","Quelle est ta plus grande peur dans une relation ?","Si tu pouvais changer une chose dans ton passé, ce serait quoi ?","Quelle est la chose qui te rend le plus heureuse dans notre couple ?","Quel a été le moment où tu t'es sentie le plus vulnérable avec moi ?","Si tu pouvais choisir une destination pour un voyage romantique, ce serait où et pourquoi ?","Qu'est-ce qui te fait le plus peur de vieillir ensemble ?","Comment me décrirais-tu en tant qu'amant(e) ?",];const authPromise=new Promise((resolve)=>{if(typeof __initial_auth_token!=='undefined'){signInWithCustomToken(auth,__initial_auth_token).then(userCredential=>{userId=userCredential.user.uid;console.log("Authenticated successfully with custom token.",userId);resolve();}).catch(error=>{console.error("Custom token login failed:",error);signInAnonymously(auth).then(anonUser=>{userId=anonUser.user.uid;console.log("Signed in anonymously.",userId);resolve();}).catch(anonError=>{console.error("Anonymous login failed:",anonError);statusMessage.textContent="Erreur de connexion. Veuillez rafraîchir la page.";});});}else{signInAnonymously(auth).then(anonUser=>{userId=anonUser.user.uid;console.log("Signed in anonymously.",userId);resolve();}).catch(anonError=>{console.error("Anonymous login failed:",anonError);statusMessage.textContent="Erreur de connexion. Veuillez rafraîchir la page.";});}});async function createGame(){await authPromise;myName=myNameInput.value.trim();if(!myName){statusMessage.textContent="Veuillez entrer votre nom.";return;}if(!userId){statusMessage.textContent="Authentification en cours. Veuillez réessayer dans quelques instants.";return;}statusMessage.textContent="Création de la partie...";isCreator=true;try{const gameRef=doc(collection(db,`artifacts/${appId}/public/data/games`));gameId=gameRef.id;const gameData={creatorId:userId,creatorName:myName,joinerId:null,joinerName:null,isReady:false,player1Name:'',player2Name:'',player1Answer:'',player2Answer:'',currentPlayer:1,currentQuestion:'',shuffledQuestionsHomme:JSON.stringify([...questionsPourHomme].sort(()=>Math.random()-0.5)),shuffledQuestionsFemme:JSON.stringify([...questionsPourFemme].sort(()=>Math.random()-0.5)),creationTime:new Date().toISOString(),};await setDoc(gameRef,gameData);statusMessage.textContent=`Partie créée ! Partagez ce code : ${gameId}`;gameCodeDisplay.textContent=`Code de la partie : ${gameId}`;loginScreen.style.display='none';setupScreen.style.display='block';listenToGame();}catch(error){console.error("Erreur lors de la création de la partie:",error);statusMessage.textContent="Erreur: Impossible de créer la partie. Réessayez.";}}async function joinGame(){await authPromise;myName=myNameInput.value.trim();gameId=gameIdInput.value.trim();if(!myName||!gameId){statusMessage.textContent="Veuillez entrer votre nom et le code de la partie.";return;}if(!userId){statusMessage.textContent="Authentification en cours. Veuillez réessayer dans quelques instants.";return;}statusMessage.textContent="Rejoindre la partie...";isCreator=false;const gameRef=doc(db,`artifacts/${appId}/public/data/games`,gameId);const gameSnap=await getDoc(gameRef);if(!gameSnap.exists()){statusMessage.textContent="Partie introuvable.";return;}const gameData=gameSnap.data();if(gameData.joinerId){statusMessage.textContent="Cette partie est déjà pleine.";return;}await setDoc(gameRef,{joinerId:userId,joinerName:myName,isReady:true},{merge:true});loginScreen.style.display='none';gameContainer.style.display='block';listenToGame();}async function updateGame(data){const gameRef=doc(db,`artifacts/${appId}/public/data/games`,gameId);try{await setDoc(gameRef,data,{merge:true});}catch(error){console.error("Erreur lors de la mise à jour de la partie:",error);}}function listenToGame(){const gameRef=doc(db,`artifacts/${appId}/public/data/games`,gameId);onSnapshot(gameRef,(docSnap)=>{if(docSnap.exists()){const gameData=docSnap.data();if(gameData.isReady&&loginScreen.style.display!=='none'){loginScreen.style.display='none';gameContainer.style.display='block';}if(gameData.isReady&&setupScreen.style.display!=='none'&&gameData.joinerId){setupScreen.style.display='none';gameContainer.style.display='block';if(isCreator&&!gameData.player1Name){updateGame({player1Name:gameData.creatorName,player2Name:gameData.joinerName});}}const player1Name=gameData.player1Name;const player2Name=gameData.joinerName;const myTurn=(isCreator&&gameData.currentPlayer===1)||(!isCreator&&gameData.currentPlayer===2);player1Label.textContent=`Réponse de ${player1Name||'Joueur 1'} :`;player2Label.textContent=`Réponse de ${player2Name||'Joueur 2'} :`;if(gameData.player1Answer&&gameData.player2Answer){answersDisplay.style.display='block';playerAnswerElement.style.display='none';submitButton.style.display='none';getNewQuestionsButton.style.display='none';revealedQuestion1Element.textContent=gameData.currentQuestion;revealedQuestion2Element.textContent=gameData.currentQuestion;revealedPlayer1Answer.textContent=gameData.player1Answer;revealedPlayer2Answer.textContent=gameData.player2Answer;}else if(myTurn){answersDisplay.style.display='none';playerAnswerElement.style.display='block';submitButton.style.display='block';getNewQuestionsButton.style.display='block';questionTextElement.textContent=gameData.currentQuestion?`${myName}: ${gameData.currentQuestion}`:`En attente d'une question...`;}else{answersDisplay.style.display='none';playerAnswerElement.style.display='none';submitButton.style.display='none';getNewQuestionsButton.style.display='none';questionTextElement.textContent=`En attente de la réponse de ${gameData.currentPlayer===1?player1Name:player2Name}...`;}}});}function startGame(starterRole){const partnerName=partnerNameInput.value.trim();if(!partnerName){console.error("Veuillez entrer le nom de votre partenaire.");return;}const questions=starterRole==='homme'?questionsPourHomme:questionsPourFemme;const shuffled=[...questions].sort(()=>Math.random()-0.5);const question=shuffled.shift();const data={player1Name:myName,player2Name:partnerName,player1Role:starterRole,player2Role:starterRole==='homme'?'femme':'homme',currentQuestion:question,};if(isCreator){data.shuffledQuestionsHomme=JSON.stringify(shuffled);}else{data.shuffledQuestionsFemme=JSON.stringify(shuffled);}updateGame(data);setupScreen.style.display='none';gameContainer.style.display='block';}async function submitAnswer(){const answer=playerAnswerElement.value.trim();if(!answer){console.error('Veuillez répondre à la question.');return;}const gameRef=doc(db,`artifacts/${appId}/public/data/games`,gameId);const gameSnap=await getDoc(gameRef);const gameData=gameSnap.data();if(gameData.currentPlayer===1){if(userId===gameData.creatorId){updateGame({player1Answer:answer,currentPlayer:2});}}else{if(userId===gameData.joinerId){updateGame({player2Answer:answer,currentPlayer:1});}}}async function nextQuestion(){answersDisplay.style.display='none';playerAnswerElement.style.display='block';submitButton.style.display='block';getNewQuestionsButton.style.display='block';const gameRef=doc(db,`artifacts/${appId}/public/data/games`,gameId);const gameSnap=await getDoc(gameRef);const gameData=gameSnap.data();let questions=[];let question='';if(isCreator){try{questions=JSON.parse(gameData.shuffledQuestionsHomme);}catch(e){questions=gameData.shuffledQuestionsHomme;}question=questions.shift();updateGame({player1Answer:'',player2Answer:'',currentQuestion:question,shuffledQuestionsHomme:JSON.stringify(questions)});}else{try{questions=JSON.parse(gameData.shuffledQuestionsFemme);}catch(e){questions=gameData.shuffledQuestionsFemme;}question=questions.shift();updateGame({player1Answer:'',player2Answer:'',currentQuestion:question,shuffledQuestionsFemme:JSON.stringify(questions)});}playerAnswerElement.value='';}async function getNewQuestions(){getQuestionsStatusElement.textContent="Génération de nouvelles questions...";getNewQuestionsButton.disabled=true;try{const apiKey="";const apiUrl=`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;const prompt="Génère 5 questions intimes, profondes ou amusantes pour un jeu de couple. Chaque question doit être une phrase concise, sans préambule ni explications. Formate la réponse comme une liste simple d'éléments, un par ligne. Le ton doit être romantique, intime ou amusant. Ne pas utiliser de symboles pour la liste.";const payload={contents:[{parts:[{text:prompt}]}],generationConfig:{responseMimeType:"text/plain"}};const response=await fetch(apiUrl,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});const result=await response.json();const newQuestions=result.candidates?.[0]?.content?.parts?.[0]?.text?.split('\n').filter(q=>q.trim()!=='')||[];if(newQuestions.length>0){const gameRef=doc(db,`artifacts/${appId}/public/data/games`,gameId);const gameSnap=await getDoc(gameRef);const gameData=gameSnap.data();if(isCreator){const updatedQuestions=[...JSON.parse(gameData.shuffledQuestionsHomme),...newQuestions];updateGame({shuffledQuestionsHomme:JSON.stringify(updatedQuestions)});playerAnswerElement.value='';}else{const updatedQuestions=[...JSON.parse(gameData.shuffledQuestionsFemme),...newQuestions];updateGame({shuffledQuestionsFemme:JSON.stringify(updatedQuestions)});playerAnswerElement.value='';}getQuestionsStatusElement.textContent="Questions ajoutées !";}else{getQuestionsStatusElement.textContent="Impossible de générer des questions. Réessayez.";}}catch(error){console.error("Erreur lors de la génération des questions:",error);getQuestionsStatusElement.textContent="Erreur de connexion. Réessayez.";}finally{getNewQuestionsButton.disabled=false;}}async function analyzeAnswers(){analyzeStatusElement.textContent="Analyse des réponses...";analyzeButton.disabled=true;geminiAnalysisOutput.style.display='none';const gameRef=doc(db,`artifacts/${appId}/public/data/games`,gameId);const gameSnap=await getDoc(gameRef);const gameData=gameSnap.data();try{const apiKey="";const apiUrl=`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;const prompt=`Voici une question de jeu de couple : "${gameData.currentQuestion}". ${gameData.player1Name} a répondu "${gameData.player1Answer}" et ${gameData.joinerName} a répondu "${gameData.player2Answer}". Fournis une analyse courte, amusante et romantique de leurs deux réponses en une ou deux phrases. Le ton doit être léger et positif.`;const payload={contents:[{parts:[{text:prompt}]}],generationConfig:{responseMimeType:"text/plain"}};const response=await fetch(apiUrl,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});const result=await response.json();const analysisText=result.candidates?.[0]?.content?.parts?.[0]?.text||"Impossible de fournir une analyse pour le moment.";geminiAnalysisText.textContent=analysisText;geminiAnalysisOutput.style.display='block';analyzeStatusElement.textContent="";}catch(error){console.error("Erreur lors de l'analyse:",error);analyzeStatusElement.textContent="Erreur de connexion. Réessayez.";}finally{analyzeButton.disabled=false;}}createGameButton.addEventListener('click',createGame);joinGameButton.addEventListener('click',joinGame);selectHommeButton.addEventListener('click',()=>{startGame('homme');});selectFemmeButton.addEventListener('click',()=>{startGame('femme');});submitButton.addEventListener('click',submitAnswer);nextButton.addEventListener('click',nextQuestion);getNewQuestionsButton.addEventListener('click',getNewQuestions);analyzeButton.addEventListener('click',analyzeAnswers);</script></body></html>
